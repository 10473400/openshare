"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}();!function t(e,a,r){function n(s,o){if(!a[s]){if(!e[s]){var u="function"==typeof require&&require;if(!o&&u)return u(s,!0);if(i)return i(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=a[s]={exports:{}};e[s][0].call(l.exports,function(t){var a=e[s][1][t];return n(a?a:t)},l,l.exports,t,e,a,r)}return a[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,a){!function(){var e=t("./modules/open-share"),a=t("./modules/data-attr"),r=t("./modules/count");new a(e,r)}()},{"./modules/count":2,"./modules/data-attr":3,"./modules/open-share":4}],2:[function(t,e,a){e.exports=function(){function t(e,a){var r=this;if(_classCallCheck(this,t),!a)throw new Error("Open Share: no url provided for count");if(e.indexOf(",")>-1)this.type=e,this.typeArr=this.type.split(","),this.countData=[],this.typeArr.forEach(function(t){if(!r[t])throw new Error("Open Share: "+e+" is an invalid count type");r.countData.push(r[t](a))});else{if(!this[e])throw new Error("Open Share: "+e+" is an invalid count type");this.type=e,this.countData=this[e](a)}}return _createClass(t,[{key:"count",value:function(t){this.os=t,Array.isArray(this.countData)?this.getCounts():this.getCount()}},{key:"getCount",value:function(){var t=this.storeGet(this.type);t&&(this.os.innerHTML=t),this[this.countData.type](this.countData)}},{key:"getCounts",value:function(){var t=this;this.total=[];var e=this.storeGet(this.type);e&&(this.os.innerHTML=e),this.countData.forEach(function(e){t[e.type](e,function(e){if(t.total.push(e),t.total.length===t.typeArr.length){var a=0;t.total.forEach(function(t){a+=t}),t.storeSet(t.type,a),t.os.innerHTML=a}})}),this.os.innerHTML=this.total}},{key:"jsonp",value:function(t,e){var a=this,r="jsonp_"+Math.random().toString().substr(-10);window[r]=function(r){var n=t.transform(r)||0;e&&"function"==typeof e?e(n):a.os.innerHTML=n};var n=document.createElement("script");n.src=t.url.replace("callback=?","callback="+r),document.getElementsByTagName("head")[0].appendChild(n)}},{key:"get",value:function(t,e){var a=this,r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE&&200===r.status){var n=t.transform(r)||0;e&&"function"==typeof e?e(n):a.os.innerHTML=n}},r.open("GET",t.url),r.send()}},{key:"post",value:function(t,e){var a=this,r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE&&200===r.status){var n=t.transform(r)||0;e&&"function"==typeof e?e(n):a.os.innerHTML=n}},r.open("POST",t.url),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.send(JSON.stringify(t.data))}},{key:"storeSet",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1];window.localStorage&&t&&localStorage.setItem("OpenShare-"+t,e)}},{key:"storeGet",value:function(t){return window.localStorage&&t?localStorage.getItem("OpenShare-"+t):void 0}},{key:"facebook",value:function(t){var e=this;return{type:"get",url:"http://graph.facebook.com/?id="+t,transform:function(t){var a=JSON.parse(t.responseText).shares;return e.storeSet(e.type,a),a}}}},{key:"pinterest",value:function(t){var e=this;return{type:"jsonp",url:"http://api.pinterest.com/v1/urls/count.json?callback=?&url="+t,transform:function(t){var a=t.count;return e.storeSet(e.type,a),a}}}},{key:"linkedin",value:function(t){var e=this;return{type:"jsonp",url:"http://www.linkedin.com/countserv/count/share?url="+t+"&format=jsonp&callback=?",transform:function(t){var a=t.count;return e.storeSet(e.type,a),a}}}},{key:"reddit",value:function(t){var e=this;return{type:"get",url:"https://www.reddit.com/api/info.json?url="+t,transform:function(t){var a=JSON.parse(t.responseText).data.children,r=0;return a.forEach(function(t){r+=Number(t.data.ups)}),e.storeSet(e.type,r),r}}}},{key:"google",value:function(t){var e=this;return{type:"post",data:{method:"pos.plusones.get",id:"p",params:{nolog:!0,id:t,source:"widget",userId:"@viewer",groupId:"@self"},jsonrpc:"2.0",key:"p",apiVersion:"v1"},url:"https://clients6.google.com/rpc",transform:function(t){var a=JSON.parse(t.responseText).result.metadata.globalCounts.count;return e.storeSet(e.type,a),a}}}}]),t}()},{}],3:[function(t,e,a){e.exports=function(){function t(e,a){_classCallCheck(this,t),this.OpenShare=e,this.Count=a,document.addEventListener("OpenShare.load",this.init.bind(this)),document.addEventListener("DOMContentLoaded",this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){this.initializeNodes(),void 0!==window.MutationObserver&&this.initializeWatcher(document.querySelectorAll("[data-open-share-watch]"))}},{key:"initializeNodes",value:function(){var t=arguments.length<=0||void 0===arguments[0]?document:arguments[0],e=t.querySelectorAll("[data-open-share]:not([data-open-share-node])");[].forEach.call(e,this.initializeShareNode.bind(this));var a=t.querySelectorAll("[data-open-share-count]:not([data-open-share-node])");[].forEach.call(a,this.initializeCountNode.bind(this));var r=document.createEvent("Event");r.initEvent("OpenShare.loaded",!0,!0),document.dispatchEvent(r)}},{key:"initializeCountNode",value:function(t){var e=t.getAttribute("data-open-share-count"),a=new this.Count(e,t.getAttribute("data-open-share-count-url"));a.count(t),t.setAttribute("data-open-share-node",e)}},{key:"initializeShareNode",value:function(t){var e=this,a=t.getAttribute("data-open-share"),r=a.indexOf("-"),n=void 0;if(r>-1){var i=a.substr(r+1,1),s=a.substr(r,2);a=a.replace(s,i.toUpperCase())}n=new this.OpenShare(a),t.getAttribute("data-open-share-dynamic")&&(n.dynamic=!0),this.setData(n,t),t.addEventListener("click",function(a){n.dynamic&&e.setData(n,t),n.share(a);var r=document.createEvent("Event");r.initEvent("OpenShare.shared",!0,!0),t.dispatchEvent(r)}),t.setAttribute("data-open-share-node",a)}},{key:"initializeWatcher",value:function(t){var e=this;[].forEach.call(t,function(t){var a=new MutationObserver(function(t){e.initializeNodes(t[0].target)});a.observe(t,{childList:!0})})}},{key:"setData",value:function(t,e){t.setData({url:e.getAttribute("data-open-share-url"),text:e.getAttribute("data-open-share-text"),via:e.getAttribute("data-open-share-via"),hashtags:e.getAttribute("data-open-share-hashtags"),ios:e.getAttribute("data-open-share-ios"),tweetId:e.getAttribute("data-open-share-tweet-id"),related:e.getAttribute("data-open-share-related"),screenName:e.getAttribute("data-open-share-screen-name"),userId:e.getAttribute("data-open-share-user-id"),link:e.getAttribute("data-open-share-link"),picture:e.getAttribute("data-open-share-picture"),caption:e.getAttribute("data-open-share-caption"),description:e.getAttribute("data-open-share-description"),title:e.getAttribute("data-open-share-title"),media:e.getAttribute("data-open-share-media"),to:e.getAttribute("data-open-share-to"),subject:e.getAttribute("data-open-share-subject"),body:e.getAttribute("data-open-share-body")})}}]),t}()},{}],4:[function(t,e,a){e.exports=function(){function t(e){if(_classCallCheck(this,t),!this[e])throw new Error("Open Share: "+e+" is an invalid type");this.ios=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,this.type=e,this.dynamic=!1,this.typeCaps=e.charAt(0).toUpperCase()+e.slice(1)}return _createClass(t,[{key:"setData",value:function(t){return this[this.type](t)}},{key:"share",value:function(t){var e=this;if(this.iosShareUrl){window.location=this.iosShareUrl;var a=(new Date).valueOf();setTimeout(function(){var t=(new Date).valueOf();t-a>3e3||window.open(e.shareUrl,"OpenShare")},2e3)}else"email"===this.type?window.location=this.shareUrl:window.open(this.shareUrl,"OpenShare")}},{key:"template",value:function(t,e){var a=t,r=void 0;for(r in e)e[r]&&(e[r]=encodeURIComponent(e[r]),a+=r+"="+e[r]+"&");return a.substr(0,a.length-1)}},{key:"twitter",value:function(t){if(this.ios&&t.ios){var e="";if(t.text&&(e+=t.text),t.url&&(e+=" - "+t.url),t.hashtags){var a=t.hashtags.split(",");a.forEach(function(t){e+=" #"+t})}t.via&&(e+=" via "+t.via),this.iosShareUrl=this.template("twitter://post?",{message:e})}this.shareUrl=this.template("https://twitter.com/share?",t)}},{key:"twitterRetweet",value:function(t){this.ios&&t.ios&&(this.iosShareUrl=this.template("twitter://status?",{id:t.tweetId})),this.shareUrl=this.template("https://twitter.com/intent/retweet?",{tweet_id:t.tweetId,related:t.related})}},{key:"twitterLike",value:function(t){this.ios&&t.ios&&(this.iosShareUrl=this.template("twitter://status?",{id:t.tweetId})),this.shareUrl=this.template("https://twitter.com/intent/favorite?",{tweet_id:t.tweetId,related:t.related})}},{key:"twitterFollow",value:function(t){if(this.ios&&t.ios){var e=t.screenName?{screen_name:t.screenName}:{id:t.userId};this.iosShareUrl=this.template("twitter://user?",e)}this.shareUrl=this.template("https://twitter.com/intent/user?",{screen_name:t.screenName,user_id:t.userId})}},{key:"facebook",value:function(t){this.shareUrl=this.template("https://www.facebook.com/dialog/feed?app_id=961342543922322&redirect_uri=http://facebook.com&",t)}},{key:"facebookSend",value:function(t){this.shareUrl=this.template("https://www.facebook.com/dialog/send?app_id=961342543922322&redirect_uri=http://facebook.com&",t)}},{key:"google",value:function(t){this.shareUrl=this.template("https://plus.google.com/share?",t)}},{key:"pinterest",value:function(t){this.shareUrl=this.template("https://pinterest.com/pin/create/bookmarklet/?",t)}},{key:"linkedin",value:function(t){this.shareUrl=this.template("http://www.linkedin.com/shareArticle?",t)}},{key:"buffer",value:function(t){this.shareUrl=this.template("http://bufferapp.com/add?",t)}},{key:"tumblr",value:function(t){this.shareUrl=this.template("https://www.tumblr.com/widgets/share/tool?",t)}},{key:"reddit",value:function(t){this.shareUrl=this.template("http://reddit.com/submit?",t)}},{key:"whatsapp",value:function(t){this.shareUrl=this.template("whatsapp://send?",t)}},{key:"sms",value:function(t){this.shareUrl=this.template(this.ios?"sms:&":"sms:?",t)}},{key:"email",value:function(t){var e="mailto:";null!==t.to&&(e+=""+t.to),e+="?",this.shareUrl=this.template(e,{subject:t.subject,body:t.body})}}]),t}()},{}]},{},[1]);